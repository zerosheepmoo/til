<!DOCTYPE html>
<html lang="ko-KR">
  <head>
    <title>Custom Elements | TIL</title><meta name="description" content="오늘 내가 배운 것들"><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="generator" content="VuePress 2.0.0-beta.12">
    <link rel="preload" href="/til/assets/js/runtime~app.93d34e3c.js" as="script"><link rel="preload" href="/til/assets/css/styles.e099cbea.css" as="style"><link rel="preload" href="/til/assets/js/8413.98dd209d.js" as="script"><link rel="preload" href="/til/assets/js/app.46f3edf0.js" as="script">
    <link rel="stylesheet" href="/til/assets/css/styles.e099cbea.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><header class="navbar"><div class="toggle-sidebar-button"><svg class="icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z" class=""></path></svg></div><span><a href="/til/" class=""><img class="logo" src="/til//images/logo.png" alt="TIL"><span class="site-name can-hide">TIL</span></a></span><div class="navbar-links-wrapper" style=""><!--[--><!--]--><nav class="navbar-links can-hide"><!--[--><div class="navbar-links-item"><a href="/til/study/" class="nav-link" aria-label="Study"><!--[--><!--]--> Study <!--[--><!--]--></a></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="ProgramLangs"><span class="title">ProgramLangs</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="ProgramLangs"><span class="title">ProgramLangs</span><span class="right arrow"></span></button><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a href="/til/program-langs/javascript/" class="nav-link" aria-label="Javascript"><!--[--><!--]--> Javascript <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/til/program-langs/typescript/" class="nav-link" aria-label="Typescript"><!--[--><!--]--> Typescript <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="Select language"><span class="title">Languages</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="Select language"><span class="title">Languages</span><span class="right arrow"></span></button><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a aria-current="page" href="/til/google-webfun/wc-custom-elements.html" class="router-link-active router-link-exact-active nav-link router-link-active" aria-label="한국어"><!--[--><!--]--> 한국어 <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/til/en/" class="nav-link" aria-label="English"><!--[--><!--]--> English <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-links-item"><a class="nav-link external" href="https://github.com/zerosheepmoo/til" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><!----></div></header><div class="sidebar-mask"></div><aside class="sidebar"><nav class="navbar-links"><!--[--><div class="navbar-links-item"><a href="/til/study/" class="nav-link" aria-label="Study"><!--[--><!--]--> Study <!--[--><!--]--></a></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="ProgramLangs"><span class="title">ProgramLangs</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="ProgramLangs"><span class="title">ProgramLangs</span><span class="right arrow"></span></button><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a href="/til/program-langs/javascript/" class="nav-link" aria-label="Javascript"><!--[--><!--]--> Javascript <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/til/program-langs/typescript/" class="nav-link" aria-label="Typescript"><!--[--><!--]--> Typescript <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="Select language"><span class="title">Languages</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="Select language"><span class="title">Languages</span><span class="right arrow"></span></button><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a aria-current="page" href="/til/google-webfun/wc-custom-elements.html" class="router-link-active router-link-exact-active nav-link router-link-active" aria-label="한국어"><!--[--><!--]--> 한국어 <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/til/en/" class="nav-link" aria-label="English"><!--[--><!--]--> English <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-links-item"><a class="nav-link external" href="https://github.com/zerosheepmoo/til" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-links"><!--[--><!--[--><section class="sidebar-group"><p class="sidebar-heading">Custom Elements</p><ul class=""><li><!--[--><a aria-current="page" href="/til/google-webfun/wc-custom-elements.html#새로운-엘리먼트-정의하기" class="router-link-active router-link-exact-active nav-link sidebar-link" aria-label="새로운 엘리먼트 정의하기"><!--[--><!--]--> 새로운 엘리먼트 정의하기 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/til/google-webfun/wc-custom-elements.html#엘리먼트의-javascript-api-정의하기" class="router-link-active router-link-exact-active nav-link sidebar-link" aria-label="엘리먼트의 JavaScript API 정의하기"><!--[--><!--]--> 엘리먼트의 JavaScript API 정의하기 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/til/google-webfun/wc-custom-elements.html#커스텀-엘리먼트-리액션" class="router-link-active router-link-exact-active nav-link sidebar-link" aria-label="커스텀 엘리먼트 리액션"><!--[--><!--]--> 커스텀 엘리먼트 리액션 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/til/google-webfun/wc-custom-elements.html#프로퍼티와-어트리뷰트" class="router-link-active router-link-exact-active nav-link sidebar-link" aria-label="프로퍼티와 어트리뷰트"><!--[--><!--]--> 프로퍼티와 어트리뷰트 <!--[--><!--]--></a><ul class="sidebar-sub-headers"><li><!--[--><a aria-current="page" href="/til/google-webfun/wc-custom-elements.html#reflecting-properties-to-attributes" class="router-link-active router-link-exact-active nav-link sidebar-link" aria-label="Reflecting properties to attributes"><!--[--><!--]--> Reflecting properties to attributes <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/til/google-webfun/wc-custom-elements.html#observing-changes-to-attributes" class="router-link-active router-link-exact-active nav-link sidebar-link" aria-label="Observing changes to attributes"><!--[--><!--]--> Observing changes to attributes <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--></li><li><!--[--><a aria-current="page" href="/til/google-webfun/wc-custom-elements.html#엘리먼트-갱신" class="router-link-active router-link-exact-active nav-link sidebar-link" aria-label="엘리먼트 갱신"><!--[--><!--]--> 엘리먼트 갱신 <!--[--><!--]--></a><ul class="sidebar-sub-headers"><li><!--[--><a aria-current="page" href="/til/google-webfun/wc-custom-elements.html#progressively-enhanced-html" class="router-link-active router-link-exact-active nav-link sidebar-link" aria-label="Progressively enhanced HTML"><!--[--><!--]--> Progressively enhanced HTML <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--></li><li><!--[--><a aria-current="page" href="/til/google-webfun/wc-custom-elements.html#element-defined-콘텐츠" class="router-link-active router-link-exact-active nav-link sidebar-link" aria-label="Element-defined 콘텐츠"><!--[--><!--]--> Element-defined 콘텐츠 <!--[--><!--]--></a><ul class="sidebar-sub-headers"><li><!--[--><a aria-current="page" href="/til/google-webfun/wc-custom-elements.html#섀도우돔-사용하는-엘리먼트-만들기" class="router-link-active router-link-exact-active nav-link sidebar-link" aria-label="섀도우돔 사용하는 엘리먼트 만들기"><!--[--><!--]--> 섀도우돔 사용하는 엘리먼트 만들기 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/til/google-webfun/wc-custom-elements.html#template으로-엘리먼트-만들기" class="router-link-active router-link-exact-active nav-link sidebar-link" aria-label="template으로 엘리먼트 만들기"><!--[--><!--]--> template으로 엘리먼트 만들기 <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--></li><li><!--[--><a aria-current="page" href="/til/google-webfun/wc-custom-elements.html#커스텀-엘리먼트-스타일링" class="router-link-active router-link-exact-active nav-link sidebar-link" aria-label="커스텀 엘리먼트 스타일링"><!--[--><!--]--> 커스텀 엘리먼트 스타일링 <!--[--><!--]--></a><ul class="sidebar-sub-headers"><li><!--[--><a aria-current="page" href="/til/google-webfun/wc-custom-elements.html#pre-styling-unregistered-elements" class="router-link-active router-link-exact-active nav-link sidebar-link" aria-label="Pre-styling unregistered elements"><!--[--><!--]--> Pre-styling unregistered elements <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--></li><li><!--[--><a aria-current="page" href="/til/google-webfun/wc-custom-elements.html#엘리먼트-확장하기" class="router-link-active router-link-exact-active nav-link sidebar-link" aria-label="엘리먼트 확장하기"><!--[--><!--]--> 엘리먼트 확장하기 <!--[--><!--]--></a><ul class="sidebar-sub-headers"><li><!--[--><a aria-current="page" href="/til/google-webfun/wc-custom-elements.html#extending-a-custom-element" class="router-link-active router-link-exact-active nav-link sidebar-link" aria-label="Extending a custom element"><!--[--><!--]--> Extending a custom element <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/til/google-webfun/wc-custom-elements.html#extending-native-html-elements" class="router-link-active router-link-exact-active nav-link sidebar-link" aria-label="Extending native HTML elements"><!--[--><!--]--> Extending native HTML elements <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--></li><li><!--[--><a aria-current="page" href="/til/google-webfun/wc-custom-elements.html#misc-details" class="router-link-active router-link-exact-active nav-link sidebar-link" aria-label="Misc details"><!--[--><!--]--> Misc details <!--[--><!--]--></a><ul class="sidebar-sub-headers"><li><!--[--><a aria-current="page" href="/til/google-webfun/wc-custom-elements.html#unknown-elements-vs-undefined-custom-elements" class="router-link-active router-link-exact-active nav-link sidebar-link" aria-label="Unknown elements vs. undefined custom elements"><!--[--><!--]--> Unknown elements vs. undefined custom elements <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--></li><li><!--[--><a aria-current="page" href="/til/google-webfun/wc-custom-elements.html#api-reference" class="router-link-active router-link-exact-active nav-link sidebar-link" aria-label="API Reference"><!--[--><!--]--> API Reference <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/til/google-webfun/wc-custom-elements.html#history-and-browser-support" class="router-link-active router-link-exact-active nav-link sidebar-link" aria-label="History and browser support"><!--[--><!--]--> History and browser support <!--[--><!--]--></a><ul class="sidebar-sub-headers"><li><!--[--><a aria-current="page" href="/til/google-webfun/wc-custom-elements.html#browser-support" class="router-link-active router-link-exact-active nav-link sidebar-link" aria-label="Browser support"><!--[--><!--]--> Browser support <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/til/google-webfun/wc-custom-elements.html#polyfill" class="router-link-active router-link-exact-active nav-link sidebar-link" aria-label="Polyfill"><!--[--><!--]--> Polyfill <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--></li></ul></section><!--]--><!--]--></ul><!--[--><!--]--></aside><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><h1 id="custom-elements"><a class="header-anchor" href="#custom-elements">#</a> Custom Elements</h1><div class="custom-container tip"><p class="custom-container-title">note</p><p>이 섹션은 <a href="https://html.spec.whatwg.org/multipage/scripting.html#custom-elements" target="_blank" rel="noopener noreferrer">Custom Elements Spec<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a> 에 대해 설명한다.</p><p>예전거랑 API 가 다르니 <a href="#history-and-browser-support">커스텀 엘리먼트 히스토리</a>를 참고하자.</p></div><p>브라우저는 웹 어플리케이션을 구축하기 위한 완벽한 도구를 제공한다. 당신이 들어봤을 법한 그것은 바로 HTML!</p><p>그것은 declarative, portable, well supported, 그리고 easy to work with 하다!</p><p>HTML은 훌륭하지만, 용어와 확장성은 제한적이다. <a href="https://html.spec.whatwg.org/multipage/" target="_blank" rel="noopener noreferrer">HTML Living Standards<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a>는 항상 JS behavior 를 markup과 자동으로 associate하는 방법이 없었다...</p><p>이 글을 읽기전까진!</p><details class="custom-container details"><summary>원본</summary><blockquote><p>The browser gives us an excellent tool for structuring web applications. It&#39;s called HTML. You may have heard of it! It&#39;s declarative, portable, well supported, and easy to work with. Great as HTML may be, its vocabulary and extensibility are limited. The HTML living standard has always lacked a way to automatically associate JS behavior with your markup... until now.</p></blockquote></details><p>커스텀 엘리먼트는 HTML 을 모던화하고, 잃어버린 조각을 채우며, behavior 와 함께 구조를 번들링하는 것에 대한 해답이다. HTML 이 문제에 대한 해답을 제공하지 않는다면, 커스텀 엘리먼트를 생성하여 해결할 수 있다. 커스텀 엘리먼트는 HTML의 이점은 그대로 유지하면서 브라우저를 다루는 새로운 트릭을 알려준다.</p><details class="custom-container details"><summary>원본</summary><blockquote><p>Custom elements are the answer to modernizing HTML, filling in the missing pieces, and bundling structure with behavior. If HTML doesn&#39;t provide the solution to a problem, we can create a custom element that does. Custom elements teach the browser new tricks while preserving the benefits of HTML.</p></blockquote></details><h2 id="새로운-엘리먼트-정의하기"><a class="header-anchor" href="#새로운-엘리먼트-정의하기">#</a> 새로운 엘리먼트 정의하기</h2><p>새로운 HTML element 를 정의하기 위해서는 자바스크립트의 힘이 필요하다!</p><p><code>customElements</code> global은 커스텀 엘리먼트를 정의하고 브라우저에게 새로운 태그를 알려준다. <code>customElements.define()</code>을 <strong>원하는 태그명</strong>과 <strong>HTMLElement를 extends 한 Javascript 클래스</strong>와 함께 호출하자.</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">AppDrawer</span> <span class="token keyword">extends</span> <span class="token class-name">HTMLElement</span> <span class="token punctuation">{</span><span class="token operator">...</span><span class="token punctuation">}</span>
window<span class="token punctuation">.</span>customElements<span class="token punctuation">.</span><span class="token function">define</span><span class="token punctuation">(</span><span class="token string">&#39;app-drawer&#39;</span><span class="token punctuation">,</span> AppDrawer<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Or use an anonymous class if you don&#39;t want a named constructor in current scope.</span>
window<span class="token punctuation">.</span>customElements<span class="token punctuation">.</span><span class="token function">define</span><span class="token punctuation">(</span><span class="token string">&#39;app-drawer&#39;</span><span class="token punctuation">,</span> <span class="token keyword">class</span> <span class="token class-name">extends</span> HTMLElement <span class="token punctuation">{</span><span class="token operator">...</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ul><li>사용 예시</li></ul><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>app-drawer</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>app-drawer</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p><code>&lt;div&gt;</code> 같은 엘리먼트들을 사용하는 것과 차이가 없다! 인스턴스는 페이지에 선언되며, javascript 에서 동적으로 생성하고, event listener 까지 걸 수 있다!</p><h2 id="엘리먼트의-javascript-api-정의하기"><a class="header-anchor" href="#엘리먼트의-javascript-api-정의하기">#</a> 엘리먼트의 JavaScript API 정의하기</h2><p>커스텀 엘리먼트의 functionality는 <code>HTMLElement</code>를 <code>extends</code>한 ES2015 class 에 의해 정의된다. <code>HTMLElement</code>를 확장하는 것으로 커스텀 엘리먼트가 모든 DOM API를 상속하는 것을 보장한다. 즉, 해당 클래스에 추가하는 모든 프로퍼티 / 메소드는 엘리먼트의 DOM 인터페이스가 된다.</p><ul><li>예시 코드</li></ul><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">AppDrawer</span> <span class="token keyword">extends</span> <span class="token class-name">HTMLElement</span> <span class="token punctuation">{</span>

  <span class="token comment">// A getter/setter for an open property.</span>
  <span class="token keyword">get</span> <span class="token function">open</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">hasAttribute</span><span class="token punctuation">(</span><span class="token string">&#39;open&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">set</span> <span class="token function">open</span><span class="token punctuation">(</span><span class="token parameter">val</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Reflect the value of the open property as an HTML attribute.</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>val<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">&#39;open&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">removeAttribute</span><span class="token punctuation">(</span><span class="token string">&#39;open&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">toggleDrawer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// A getter/setter for a disabled property.</span>
  <span class="token keyword">get</span> <span class="token function">disabled</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">hasAttribute</span><span class="token punctuation">(</span><span class="token string">&#39;disabled&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">set</span> <span class="token function">disabled</span><span class="token punctuation">(</span><span class="token parameter">val</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Reflect the value of the disabled property as an HTML attribute.</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>val<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">&#39;disabled&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">removeAttribute</span><span class="token punctuation">(</span><span class="token string">&#39;disabled&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// Can define constructor arguments if you wish.</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// If you define a constructor, always call super() first!</span>
    <span class="token comment">// This is specific to CE and required by the spec.</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Setup a click listener on &lt;app-drawer&gt; itself.</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;click&#39;</span><span class="token punctuation">,</span> <span class="token parameter">e</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token comment">// Don&#39;t toggle the drawer if it&#39;s disabled.</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>disabled<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">toggleDrawer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">toggleDrawer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

customElements<span class="token punctuation">.</span><span class="token function">define</span><span class="token punctuation">(</span><span class="token string">&#39;app-drawer&#39;</span><span class="token punctuation">,</span> AppDrawer<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br></div></div><p>여기서는 <code>open</code>,<code>disabled</code> 프로퍼티와 <code>toggleDrawer()</code> 메소드를 갖고있는 drawer를 만들었다. 당연히 HTML 어트리뷰트들을 프로퍼티 형태로 반영하고 있다.</p><p>custom element의 깔끔한 점은 클래스 정의 내에서 DOM 엘리먼트 자체(클래스의 인스턴스)를 참조한다는 것이다. 이 예에서는 <code>&lt;app-drawer&gt;</code>를 말한다.</p><p>이는 엘리먼트가 독자적인 <code>click</code> 리스너를 연결할 수 있는 방법을 알려준다.</p><p>이벤트 리스너에만 국한되지도 않는다. 모든 DOM API는 엘리먼트 코드 내에서 사용 가능하다.</p><p>이를 사용하여 엘리먼트의 프로퍼티에 접근하고, 하위 항목(<code>this.children</code>)이나 쿼리 노드(<code>this.querySelectorAll ( &#39;. items&#39;)</code>) 등을 inspection 하자</p><h2 id="커스텀-엘리먼트-리액션"><a class="header-anchor" href="#커스텀-엘리먼트-리액션">#</a> 커스텀 엘리먼트 리액션</h2><p>커스텀 엘리먼트가 살아있는 동안 코드를 실행하기 위한 특별한 <strong>라이프사이클 훅</strong>(<code>lifecycle hook</code>)을 정의할 수 있다. 이를 <strong>커스텀 엘리먼트 리액션</strong>이라고 한다.</p><table><thead><tr><th style="text-align:center;">Name</th><th style="text-align:left;">Called when</th></tr></thead><tbody><tr><td style="text-align:center;"><p><code>constructor</code></p></td><td style="text-align:left;"><ul><li>엘리먼트의 인스턴스가 생성되거나 <a href="#element-upgrades">갱신 될 때</a></li><li>state 초기화, event listeners 세팅, 또는 <a href="#shadow-dom">섀도우돔</a> 을 생성할 때 유용하다.</li><li><a href="https://html.spec.whatwg.org/multipage/scripting.html#custom-element-conformance" target="_blank" rel="noopener noreferrer">spec<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a></li></ul></td></tr><tr><td style="text-align:center;"><p><code>connected</code></p></td><td style="text-align:left;"><ul><li>DOM 에 element 가 insert 될 때마다</li><li>setup code(such as fetching resources or rendering) 실행에 유용하다.</li><li>대게 지금까지 작업 delay 하는데 사용했을 것이다.<sup class="footnote-ref"><a href="#fn1" id="fnref1">[1]</a></sup></li></ul></td></tr><tr><td style="text-align:center;"><p><code>disconnected</code></p></td><td style="text-align:left;"><ul><li>DOM 에서 element 가 제거될 때마다</li><li>clean up code를 실행할 때 유용한다.</li></ul></td></tr><tr><td style="text-align:center;"><p><code>attributeChangedCallback(attrName, oldVal, newVal)</code></p></td><td style="text-align:left;"><ul><li><a href="#observing-changes-to-attributes">observed 어트리뷰트</a> 가 추가, 제거, 갱신, 치환될 때</li><li>또, parser에 의해 엘리먼트가 생성될 때, 엘리먼트가 갱신될 때의 초기값에 대해서 호출된다.</li><li>주의: <code>observedAttributes</code> 프로퍼티에 열거된 어트리뷰트만 이 콜백을 받을 수 있다.</li></ul></td></tr><tr><td style="text-align:center;"><p><code>adoptedCallback</code></p></td><td style="text-align:left;"><p>커스텀 엘리먼트가 새로운 <code>document</code> 로 옮겨질 때</p><ul><li>예를 들어, <code>document.adoptNode(el)</code> 가 호출될 때.</li></ul></td></tr></tbody></table><div class="custom-container warning"><p class="custom-container-title">Note</p><p>Note: 브라우저는<code>attributeChangedCallback()</code> 을 <code>observedAttributes</code> array 안에 list 되어있는 어트리뷰트에 대해서만 호출한다. <a href="#observing-changes-to-attributes">어트리뷰트 변화 관찰하기</a></p><p>본질적으로 이것은 성능 최적화다. 사용자가 <code>style</code>이나 <code>class</code>같은 공통 속성을 변경할 때 수많은 콜백으로 스팸당하길 원하지 않는다.</p></div><p><strong>리액션 콜백은 동기적</strong>이다.</p><p>누군가 <code>el.setAttribute()</code> 를 엘리먼트에서 호출 했다면, 브라우저는 곧바로 <code>attributeChangedCallback()</code>를 호출한다. 또 다른 예로, 엘리먼트가 DOM 에서 제거 되었을 때(예를들면, 사용자가 <code>el.remove()</code>를 호출했을 때), <code>disconnectedCallback()</code>를 바로 호출한다.</p><ul><li><code>&lt;app-drawer&gt;</code>에 커스텀엘리먼트 리액션 추가하기</li></ul><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">AppDrawer</span> <span class="token keyword">extends</span> <span class="token class-name">HTMLElement</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// always call super() first in the constructor.</span>
    <span class="token operator">...</span>
  <span class="token punctuation">}</span>
  <span class="token function">connectedCallback</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>
  <span class="token punctuation">}</span>
  <span class="token function">disconnectedCallback</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>
  <span class="token punctuation">}</span>
  <span class="token function">attributeChangedCallback</span><span class="token punctuation">(</span><span class="token parameter">attrName<span class="token punctuation">,</span> oldVal<span class="token punctuation">,</span> newVal</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>논리적으로 말이 될 때, 리액션을 정의하자. 만약 엘리먼트가 충분히 복잡하고, <code>connectedCallback()</code> 안에서 IndexedDB 로의 connection을 열었을 때, 필수적인 cleanup 작업을 <code>disconnectedCallback()</code>안에서 하자.</p><p>하지만 조심하라! 엘리먼트가 DOM으로 부터 제거 되었다는 것을 모든 상황에서 보장할 수 없다. 예를 들어 사용자가 탭을 닫았을 경우, <code>disconnectedCallback()</code>는 호출되지 않아.</p><h2 id="프로퍼티와-어트리뷰트"><a class="header-anchor" href="#프로퍼티와-어트리뷰트">#</a> 프로퍼티와 어트리뷰트</h2><h3 id="reflecting-properties-to-attributes"><a class="header-anchor" href="#reflecting-properties-to-attributes">#</a> Reflecting properties to attributes</h3><ul><li>HTML 프로퍼티가 HTML attribute 형태로 값이 반영되는 것은 매우 일반적인 일이다.</li><li>예시 코드: <code>hidden</code> 또는 <code>id</code> 값이 JS 변경된 경우</li></ul><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>div<span class="token punctuation">.</span>id <span class="token operator">=</span> <span class="token string">&#39;my-id&#39;</span><span class="token punctuation">;</span>
div<span class="token punctuation">.</span>hidden <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li>값은 살아있는 DOM에 attributes로 적용된다</li></ul><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>my-id<span class="token punctuation">&quot;</span></span> <span class="token attr-name">hidden</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>이를 <a href="https://html.spec.whatwg.org/multipage/common-dom-interfaces.html#reflecting-content-attributes-in-idl-attributes" target="_blank" rel="noopener noreferrer">&quot;reflecting properties to attributes&quot;(프로퍼티를 어트리뷰트에 반영)<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a> 라 부른다.</p><p>대부분 HTML 의 프로퍼티는 다 그렇다. 왜냐? 어트리뷰트는 엘리먼트를 선언적으로 configuring 하는데 유용하고, 몇 API들(접근성이나 CSS 선택자같은 경우) attribute 에 의존적으로 작동하기 때문이다.</p><p>이는 엘리먼트의 DOM representation과 자바스크립트 상태를 <strong>동기화</strong>하는 것을 유지할 때 유용하다. 프로퍼티 반영을 사용하는 이유 중 하나는 JS 상태 변화에 따른 사용자 지정 스타일링 적용일 수 있다.</p><p><code>&lt;app-drawer&gt;</code>를 떠올려보자.</p><p>소비자는 fade out 시키는 것과 <code>disabled</code> 일 때 유저와의 상호작용을 막는 것을 원한다면</p><div class="language-css ext-css line-numbers-mode"><pre class="language-css"><code><span class="token selector">app-drawer[disabled]</span> <span class="token punctuation">{</span>
  <span class="token property">opacity</span><span class="token punctuation">:</span> 0.5<span class="token punctuation">;</span>
  <span class="token property">pointer-events</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><code>disabled</code> 프로퍼티가 JS에서 변경된 경우, DOM에 어트리뷰트를 추가하여, 사용자의 셀렉터와 일치시키는 것이 좋다.</p><p>다음과 같이엘리먼트는 어트리뷰트에 값을 반영하는 behavior를 제공할 수 있다.</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token operator">...</span>

<span class="token keyword">get</span> <span class="token function">disabled</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">hasAttribute</span><span class="token punctuation">(</span><span class="token string">&#39;disabled&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">set</span> <span class="token function">disabled</span><span class="token punctuation">(</span><span class="token parameter">val</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// Reflect the value of `disabled` as an attribute.</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>val<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">&#39;disabled&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">removeAttribute</span><span class="token punctuation">(</span><span class="token string">&#39;disabled&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">toggleDrawer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h3 id="observing-changes-to-attributes"><a class="header-anchor" href="#observing-changes-to-attributes">#</a> Observing changes to attributes</h3><p>HTML 어트리뷰트는 초기 상태를 선언하기 편리하다.</p><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>app-drawer</span> <span class="token attr-name">open</span> <span class="token attr-name">disabled</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>app-drawer</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>엘리먼트들은 <code>attributeChangedCallback</code>을 정의함으로써 어트리뷰트 변경에 대한 리액션을 할 수 있다. 브라우저는 이 메소드를 <code>observedAttributes</code> array 내 list 된 어트리뷰트의 매 변경마다 호출할 것이다.</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">AppDrawer</span> <span class="token keyword">extends</span> <span class="token class-name">HTMLElement</span> <span class="token punctuation">{</span>
  <span class="token operator">...</span>

  <span class="token keyword">static</span> <span class="token keyword">get</span> <span class="token function">observedAttributes</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token string">&#39;disabled&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;open&#39;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">get</span> <span class="token function">disabled</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">hasAttribute</span><span class="token punctuation">(</span><span class="token string">&#39;disabled&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">set</span> <span class="token function">disabled</span><span class="token punctuation">(</span><span class="token parameter">val</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>val<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">&#39;disabled&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">removeAttribute</span><span class="token punctuation">(</span><span class="token string">&#39;disabled&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// Only called for the disabled and open attributes due to observedAttributes</span>
  <span class="token function">attributeChangedCallback</span><span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> oldValue<span class="token punctuation">,</span> newValue</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// When the drawer is disabled, update keyboard/screen reader behavior.</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>disabled<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">&#39;tabindex&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;-1&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">&#39;aria-disabled&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;true&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">&#39;tabindex&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;0&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">&#39;aria-disabled&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;false&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// TODO: also react to the open attribute changing.</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br></div></div><p>예시에서는 <code>&lt;app-drawer&gt;</code>에 <code>disabled</code> 어트리뷰트가 변경될 때, 추가적인 어트리뷰트를 set 했다. 비록 여기서는 다루지 않을 거지만, <strong><code>attributeChangedCallback</code> 을 JS 프로퍼티와 어트리뷰트의 동기화를 위해 사용</strong>할 수 있다.</p><h2 id="엘리먼트-갱신"><a class="header-anchor" href="#엘리먼트-갱신">#</a> 엘리먼트 갱신</h2><h3 id="progressively-enhanced-html"><a class="header-anchor" href="#progressively-enhanced-html">#</a> Progressively enhanced HTML</h3><p><code>customElements.define()</code>는 define + register 가 한번에 이루어진다는 의미는 아니다.</p><p><strong>definition 이 등록되기 전에 사용할 수 있다!</strong></p><ul><li>Progressive enhancement는 custom element의 기능이다.</li><li>다른말로하면 페이지에서 여러 <code>&lt;app-drawer&gt;</code> 엘리먼트를 선언하고 한참 뒤에도 <code>customElements.define(&#39;app-drawer&#39;, ...)</code>을 invoke 안할 수도 있다는 말이다.</li><li>이는 브라우저가 <a href="#unknown-elements-vs-undefined-custom-elements">unknown tags</a> 덕분에, 잠재적인 커스텀 엘리멘트를 다르게 처리하기 때문이다.</li><li><code>define()</code>을 호출하는 과정과 class 정의를 존재하는 엘리먼트에 endowing하는 과정을 &quot;elements upgrade&quot;라고 한다.</li></ul><p>태그 이름이 정의되는 시점을 알기 위해 <code>window.customElements.whenDefined()</code>를 사용</p><ul><li>엘리먼트가 정의될 때 resolve하는 Promise를 반환</li></ul><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>customElements<span class="token punctuation">.</span><span class="token function">whenDefined</span><span class="token punctuation">(</span><span class="token string">&#39;app-drawer&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;app-drawer defined&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li>자식 엘리먼트의 set이 갱신될 때까지 작업 지연</li></ul><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token operator">&lt;</span>share<span class="token operator">-</span>buttons<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>social<span class="token operator">-</span>button type<span class="token operator">=</span><span class="token string">&quot;twitter&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token string">&quot;...&quot;</span><span class="token operator">&gt;</span>Twitter<span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>social<span class="token operator">-</span>button<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>social<span class="token operator">-</span>button type<span class="token operator">=</span><span class="token string">&quot;fb&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token string">&quot;...&quot;</span><span class="token operator">&gt;</span>Facebook<span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>social<span class="token operator">-</span>button<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>social<span class="token operator">-</span>button type<span class="token operator">=</span><span class="token string">&quot;plus&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token string">&quot;...&quot;</span><span class="token operator">&gt;</span><span class="token constant">G</span><span class="token operator">+</span><span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>social<span class="token operator">-</span>button<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>share<span class="token operator">-</span>buttons<span class="token operator">&gt;</span>

<span class="token comment">// Fetch all the children of &lt;share-buttons&gt; that are not defined yet.</span>
<span class="token keyword">let</span> undefinedButtons <span class="token operator">=</span> buttons<span class="token punctuation">.</span><span class="token function">querySelectorAll</span><span class="token punctuation">(</span><span class="token string">&#39;:not(:defined)&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> promises <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span>undefinedButtons<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">socialButton</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> customElements<span class="token punctuation">.</span><span class="token function">whenDefined</span><span class="token punctuation">(</span>socialButton<span class="token punctuation">.</span>localName<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Wait for all the social-buttons to be upgraded.</span>
Promise<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span>promises<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// All social-button children are ready.</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><div class="custom-container warning"><p class="custom-container-title">Note</p><p>커스텀 엘리먼트가 정의되기 전 림보하는 상태라고 생각한다.</p><p><a href="https://dom.spec.whatwg.org/#concept-element-custom-element-state" target="_blank" rel="noopener noreferrer">spec<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a> 은 엘리먼트의 상태를 <strong>undefined</strong>, <strong>uncustomized</strong>, 또는 <strong>custom</strong>이라 정의한다. 빌트 인 엘리먼트(<code>&lt;div&gt;</code> 같은 것)는 항상 <strong>defined</strong>다.</p></div><h2 id="element-defined-콘텐츠"><a class="header-anchor" href="#element-defined-콘텐츠">#</a> Element-defined 콘텐츠</h2><p>커스텀 엘리먼트는 스스로의 콘텐츠를 코드 안 DOM API들을 사용하여 관리할 수 있다. 이 경우 리액션이 편리하다!</p><ul><li>default HTML 만들기</li></ul><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>customElements<span class="token punctuation">.</span><span class="token function">define</span><span class="token punctuation">(</span><span class="token string">&#39;x-foo-with-markup&#39;</span><span class="token punctuation">,</span> <span class="token keyword">class</span> <span class="token class-name">extends</span> HTMLElement <span class="token punctuation">{</span>
  <span class="token function">connectedCallback</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token string">&quot;&lt;b&gt;I&#39;m an x-foo-with-markup!&lt;/b&gt;&quot;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token operator">...</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><ul><li>결과</li></ul><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>x-foo-with-markup</span><span class="token punctuation">&gt;</span></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>b</span><span class="token punctuation">&gt;</span></span>I&#39;m an x-foo-with-markup!<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>b</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>x-foo-with-markup</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="custom-container warning"><p class="custom-container-title">Note</p><p>엘리먼트의 자식을 새로운 콘텐츠로 재작성하는 것은 일반적으로 좋은 아이디어가 아니다.(because it&#39;s unexpected) 사용자가 엘리먼트 안에 입력한 마크업이 날라가면 당황할 것이다. 이럴 때는 섀도우 돔을 사용하자.</p></div><h3 id="섀도우돔-사용하는-엘리먼트-만들기"><a class="header-anchor" href="#섀도우돔-사용하는-엘리먼트-만들기">#</a> 섀도우돔 사용하는 엘리먼트 만들기</h3><div class="custom-container warning"><p class="custom-container-title">Note</p><p>이 아티클에서는 섀도우돔의 기능을 다루지는 않을 것이다. 하지만 커스텀 엘리먼트와 조합하면 강력한 API가 된다. 섀도우 돔은 자체적으로 composition 툴이다. 커스텀 엘리먼트와 같이 사용할 경우, 마법같은 일이 일어난다.</p></div><p>섀도우 돔은 엘리먼트가 페이지의 나머지 부분과 분리 된 DOM 청크를 소유, 렌더링 및 스타일링하는 방법을 제공한다.</p><ul><li>heck, 단일 태그 내에서 전체 앱을 숨길 수도 있다.</li></ul><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token comment">&lt;!-- chat-app&#39;s implementation details are hidden away in Shadow DOM. --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>chat-app</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>chat-app</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li>커스텀 엘리먼트에서 사용하기 위해서는 <code>this.attachShadow</code> 를 constructor 내에서 호출해야한다.</li></ul><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">let</span> tmpl <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&#39;template&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
tmpl<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
  &lt;style&gt;:host { ... }&lt;/style&gt; &lt;!-- look ma, scoped styles --&gt;
  &lt;b&gt;I&#39;m in shadow dom!&lt;/b&gt;
  &lt;slot&gt;&lt;/slot&gt;
</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>

customElements<span class="token punctuation">.</span><span class="token function">define</span><span class="token punctuation">(</span><span class="token string">&#39;x-foo-shadowdom&#39;</span><span class="token punctuation">,</span> <span class="token keyword">class</span> <span class="token class-name">extends</span> HTMLElement <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// always call super() first in the constructor.</span>

    <span class="token comment">// Attach a shadow root to the element.</span>
    <span class="token keyword">let</span> shadowRoot <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">attachShadow</span><span class="token punctuation">(</span><span class="token punctuation">{</span>mode<span class="token operator">:</span> <span class="token string">&#39;open&#39;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    shadowRoot<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>tmpl<span class="token punctuation">.</span>content<span class="token punctuation">.</span><span class="token function">cloneNode</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token operator">...</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><div class="custom-container tip"><p class="custom-container-title">Note</p><p>위의 예시에서는 DOM 을 클론하기 위해 <code>shadowRoot</code> 의 <code>innerHTML</code> 에 설정하는 것 대신 <code>template</code> 엘리먼트를 사용하였다. 이 테크닉은 HTML parse 비용을 줄여준다. <code>template</code> 의 콘텐츠가 한 번 parse 되는데 반해, <code>innerHTML</code>을 <code>shadowRoot</code>에서 호출하게 되면 각 인스턴스에 HTML 을 parse 하게 된다.</p></div><ul><li>예시의 사용</li></ul><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>x-foo-shadowdom</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>b</span><span class="token punctuation">&gt;</span></span>User&#39;s<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>b</span><span class="token punctuation">&gt;</span></span> custom text<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>x-foo-shadowdom</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- renders as --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>x-foo-shadowdom</span><span class="token punctuation">&gt;</span></span>
  #shadow-root
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>b</span><span class="token punctuation">&gt;</span></span>I&#39;m in shadow dom!<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>b</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>slot</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>slot</span><span class="token punctuation">&gt;</span></span> <span class="token comment">&lt;!-- slotted content appears here --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>x-foo-shadowdom</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h3 id="template으로-엘리먼트-만들기"><a class="header-anchor" href="#template으로-엘리먼트-만들기">#</a> <code>template</code>으로 엘리먼트 만들기</h3><p><a href="https://html.spec.whatwg.org/multipage/scripting.html#the-template-element" target="_blank" rel="noopener noreferrer"><code>&lt;template&gt;</code><span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a> 엘리먼트는 parse 되고, 페이지로드시 inert 되며, runtime에 활상화되는 DOM fragments 를 선언할 수 있게 해준다. 웹 컴포넌트 패밀리의 또 다른 API primitive 다.</p><p><strong>템플릿은 커스텀 엘리먼트의 구조를 선언하는데 있어 이상적인 플레이스홀더다.</strong></p><ul><li>템플릿으로 만든 섀도우 돔 콘텐츠와 함께 엘리먼트 등록하기</li></ul><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>x-foo-from-template<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
    <span class="token selector">p</span> <span class="token punctuation">{</span> <span class="token property">color</span><span class="token punctuation">:</span> green<span class="token punctuation">;</span> <span class="token punctuation">}</span>
  </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>I&#39;m in Shadow DOM. My markup was stamped from a <span class="token entity named-entity" title="&lt;">&amp;lt;</span>template<span class="token entity named-entity" title="&gt;">&amp;gt;</span>.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    <span class="token keyword">let</span> tmpl <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&#39;#x-foo-from-template&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// If your code is inside of an HTML Import you&#39;ll need to change the above line to:</span>
  <span class="token comment">// let tmpl = document.currentScript.ownerDocument.querySelector(&#39;#x-foo-from-template&#39;);</span>

  customElements<span class="token punctuation">.</span><span class="token function">define</span><span class="token punctuation">(</span><span class="token string">&#39;x-foo-from-template&#39;</span><span class="token punctuation">,</span> <span class="token keyword">class</span> <span class="token class-name">extends</span> HTMLElement <span class="token punctuation">{</span>
      <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// always call super() first in the constructor.</span>
      <span class="token keyword">let</span> shadowRoot <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">attachShadow</span><span class="token punctuation">(</span><span class="token punctuation">{</span>mode<span class="token operator">:</span> <span class="token string">&#39;open&#39;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      shadowRoot<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>tmpl<span class="token punctuation">.</span>content<span class="token punctuation">.</span><span class="token function">cloneNode</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token operator">...</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p>이 몇줄의 코드는 강력한 한방을 가지고 있다. 어떤 일어나는지 이해해보자.</p><p>These few lines of code pack a punch. Let&#39;s understand the key things going on:</p><ol><li>HTML 에서 새로운 Element 정의함: <code>&lt;x-foo-from-template&gt;</code></li><li>엘리멘트의 섀도우 돔이 <code>&lt;template&gt;</code>로 만들어짐</li><li>섀도우돔 덕에 엘리먼트의 DOM은 엘리먼트에 대해 지역적(local)임.</li><li>섀도우돔 덕에 엘리먼트의 internal CSS 는 엘리먼트에 대해 scoped.</li></ol><h2 id="커스텀-엘리먼트-스타일링"><a class="header-anchor" href="#커스텀-엘리먼트-스타일링">#</a> 커스텀 엘리먼트 스타일링</h2><p>섀도우 돔을 이용해 엘리먼트만의 스타일링을 하더라도, 사용자가 추가로 스타일링을 할 수있다.</p><p>이걸 &quot;user-defined styles&quot;(사용자 지정 스타일)이라한다.</p><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token comment">&lt;!-- user-defined styling --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
  <span class="token selector">app-drawer</span> <span class="token punctuation">{</span>
    <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token selector">panel-item</span> <span class="token punctuation">{</span>
    <span class="token property">transition</span><span class="token punctuation">:</span> opacity 400ms ease-in-out<span class="token punctuation">;</span>
    <span class="token property">opacity</span><span class="token punctuation">:</span> 0.3<span class="token punctuation">;</span>
    <span class="token property">flex</span><span class="token punctuation">:</span> 1<span class="token punctuation">;</span>
    <span class="token property">text-align</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
    <span class="token property">border-radius</span><span class="token punctuation">:</span> 50%<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token selector">panel-item:hover</span> <span class="token punctuation">{</span>
    <span class="token property">opacity</span><span class="token punctuation">:</span> 1.0<span class="token punctuation">;</span>
    <span class="token property">background</span><span class="token punctuation">:</span> <span class="token function">rgb</span><span class="token punctuation">(</span>255<span class="token punctuation">,</span> 0<span class="token punctuation">,</span> 255<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token property">color</span><span class="token punctuation">:</span> white<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token selector">app-panel &gt; panel-item</span> <span class="token punctuation">{</span>
    <span class="token property">padding</span><span class="token punctuation">:</span> 5px<span class="token punctuation">;</span>
    <span class="token property">list-style</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
    <span class="token property">margin</span><span class="token punctuation">:</span> 0 7px<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>app-drawer</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>panel-item</span><span class="token punctuation">&gt;</span></span>Do<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>panel-item</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>panel-item</span><span class="token punctuation">&gt;</span></span>Re<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>panel-item</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>panel-item</span><span class="token punctuation">&gt;</span></span>Mi<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>panel-item</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>app-drawer</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><p>섀도우 돔에서 스타일 정의를 했음에도 어떻게 CSS 지정이 동작하는지 궁금할 것이다.</p><p>지정하는 것의 관점으로 볼땐 user styles 가 승리한다. 얘네들은 언제나 element-defined 스타일링을 오버라이드한다.</p><p><a href="#%EC%84%80%EB%8F%84%EC%9A%B0%EB%8F%94-%EC%82%AC%EC%9A%A9%ED%95%98%EB%8A%94-%EC%97%98%EB%A6%AC%EB%A8%BC%ED%8A%B8-%EB%A7%8C%EB%93%A4%EA%B8%B0">섀도우돔 사용하는 엘리먼트 만들기</a>를 참고</p><h3 id="pre-styling-unregistered-elements"><a class="header-anchor" href="#pre-styling-unregistered-elements">#</a> Pre-styling unregistered elements</h3><p>엘리먼트가 <a href="#%EC%97%98%EB%A6%AC%EB%A8%BC%ED%8A%B8-%EA%B0%B1%EC%8B%A0">갱신</a>하기 전에, CSS에서 <code>:defined</code> pseudo-class를 사용하여 타겟팅을 할 수 있다. 이는 컴포넌트를 pre-styling 하는데 유용하다. 예를 들면, 정의되지 않은 컴포넌트를 숨기고 정의 될 때 나타나게 하는 것으로, 레이아웃이나 다른 visual FOUC<sup class="footnote-ref"><a href="#fn2" id="fnref2">[2]</a></sup> 를 막을 수 있다.</p><ul><li><code>&lt;app-drawer&gt;</code>를 정의되기 전에 숨기기</li></ul><div class="language-css ext-css line-numbers-mode"><pre class="language-css"><code><span class="token selector">app-drawer:not(:defined)</span> <span class="token punctuation">{</span>
  <span class="token comment">/*Pre-style, give layout, replicate app-drawer&#39;s eventual styles, etc.*/</span>
  <span class="token property">display</span><span class="token punctuation">:</span> inline-block<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 100vh<span class="token punctuation">;</span>
  <span class="token property">opacity</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
  <span class="token property">transition</span><span class="token punctuation">:</span> opacity 0.3s ease-in-out<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><code>&lt;app-drawer&gt;</code> 가 정의되면, <code>app-drawer:not(:defined)</code> 선택자는 더 이상 매치하지 않는다.</p><h2 id="엘리먼트-확장하기"><a class="header-anchor" href="#엘리먼트-확장하기">#</a> 엘리먼트 확장하기</h2><ul><li>커스텀 엘리먼트 API 는 새로운 HTML 엘리먼트를 생성하는데 유용하다.</li><li>근데 또 다른 커스텀 엘리먼트나 브라우저의 빌트인 HTML을 확장하는데도 유용하다!</li></ul><h3 id="extending-a-custom-element"><a class="header-anchor" href="#extending-a-custom-element">#</a> Extending a custom element</h3><ul><li>class definition으로 확장한다.</li><li><code>&lt;fancy-app-drawer&gt;</code> 생성하기 (<code>&lt;app-drawer&gt;</code>를 확장하는)</li></ul><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">FancyDrawer</span> <span class="token keyword">extends</span> <span class="token class-name">AppDrawer</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// always call super() first in the constructor. This also calls the extended class&#39; constructor.</span>
    <span class="token operator">...</span>
  <span class="token punctuation">}</span>

  <span class="token function">toggleDrawer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Possibly different toggle implementation?</span>
    <span class="token comment">// Use ES2015 if you need to call the parent method.</span>
    <span class="token comment">// super.toggleDrawer()</span>
  <span class="token punctuation">}</span>

  <span class="token function">anotherMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> markdownlint<span class="token operator">-</span>enable <span class="token operator">--</span><span class="token operator">&gt;</span>
customElements<span class="token punctuation">.</span><span class="token function">define</span><span class="token punctuation">(</span><span class="token string">&#39;fancy-app-drawer&#39;</span><span class="token punctuation">,</span> FancyDrawer<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h3 id="extending-native-html-elements"><a class="header-anchor" href="#extending-native-html-elements">#</a> Extending native HTML elements</h3><p>더 팬시한 <code>&lt;button&gt;</code>을 만들고 싶어한다고 가정하자. <code>&lt;button&gt;</code> behavior와 functionality를 복제하는 것보다, 커스텀 엘리먼트를 사용하여 이미 존재하는 엘리먼트를 progressively enhance 하는 것이 낫다.</p><p>customized built-in 엘리먼트는 browser&#39;s built-in HTML 태그들을 확장한 커스텀 엘리먼트들과 같다. 가장 큰 이점은 기존 기능들(DOM properties, methods, accessibility)을 물려받는 다는 것이다. progressive 웹앱을 작성하기 위해선, 이미 존재하는 HTML 엘리먼트를 progressively enhance하는 것이 좋다!</p><div class="custom-container warning"><p class="custom-container-title">Note</p><p>지금은 Chrome 67 만 customized built-in elements(<a href="https://www.chromestatus.com/feature/4670146924773376" target="_blank" rel="noopener noreferrer">status<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a>) 를 지원한다. Edge 랑 Firefox 은 구현 예정이거나 구현중이다. 하지만 Safari 구현하지 않기로 결정했다. 이것은 접근성과 progressive enhancement에 있어 안 좋은 소식이다.</p><p>native HTML 을 확장하는 것이 유용하다고 생각한다면, 509 와 662 에 목소리를 내보자.</p><p><a href="https://github.com/w3c/webcomponents/issues/509" target="_blank" rel="noopener noreferrer">https://github.com/w3c/webcomponents/issues/509<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a><a href="https://github.com/w3c/webcomponents/issues/662" target="_blank" rel="noopener noreferrer">https://github.com/w3c/webcomponents/issues/662<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a></p></div><p>엘리먼트를 확장하기 위해 알맞은 DOM interface 를 확장하여 class definition 을 생성해야 한다. 예를 들면, <code>&lt;button&gt;</code> 을 extends 하는 엘리먼트는 <code>HTMLElement</code>를 대신 <code>HTMLButtonElement</code>를 상속해야한다.</p><p>유사하게, <code>&lt;img&gt;</code> 태그는 <code>HTMLImageElement</code> 를 상속한다.</p><ul><li><code>&lt;button&gt;</code> extends</li></ul><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// See &lt;https://html.spec.whatwg.org/multipage/indices.html#element-interfaces&gt;</span>
<span class="token comment">// for the list of other DOM interfaces.</span>
<span class="token keyword">class</span> <span class="token class-name">FancyButton</span> <span class="token keyword">extends</span> <span class="token class-name">HTMLButtonElement</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// always call super() first in the constructor.</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;click&#39;</span><span class="token punctuation">,</span> <span class="token parameter">e</span> <span class="token operator">=&gt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">drawRipple</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>offsetX<span class="token punctuation">,</span> e<span class="token punctuation">.</span>offsetY<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// Material design ripple animation.</span>
  <span class="token function">drawRipple</span><span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span> y</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> div <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&#39;div&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    div<span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&#39;ripple&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>div<span class="token punctuation">)</span><span class="token punctuation">;</span>
    div<span class="token punctuation">.</span>style<span class="token punctuation">.</span>top <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>y <span class="token operator">-</span> div<span class="token punctuation">.</span>clientHeight<span class="token operator">/</span><span class="token number">2</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">px</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
    div<span class="token punctuation">.</span>style<span class="token punctuation">.</span>left <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>x <span class="token operator">-</span> div<span class="token punctuation">.</span>clientWidth<span class="token operator">/</span><span class="token number">2</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">px</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
    div<span class="token punctuation">.</span>style<span class="token punctuation">.</span>backgroundColor <span class="token operator">=</span> <span class="token string">&#39;currentColor&#39;</span><span class="token punctuation">;</span>
    div<span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&#39;run&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    div<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;transitionend&#39;</span><span class="token punctuation">,</span> <span class="token parameter">e</span> <span class="token operator">=&gt;</span> div<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

customElements<span class="token punctuation">.</span><span class="token function">define</span><span class="token punctuation">(</span><span class="token string">&#39;fancy-button&#39;</span><span class="token punctuation">,</span> FancyButton<span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token keyword">extends</span><span class="token operator">:</span> <span class="token string">&#39;button&#39;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p>native element 를 확장할 때 <code>define()</code>을 호출이 살짝 변경되는 것에 주목하자. 세번째 파라미터는 어떤 태그를 확장할지를 브라우저에 말해준다. 이는 필수적인데, 많은 HTML 태그들이 동일한 DOM 인터페이스를 공유하고 있기 때문이다.</p><ul><li><code>&lt;section&gt;</code>, <code>&lt;address&gt;</code>, 그리고 <code>&lt;em&gt;</code> (among others) 모두 <code>HTMLElement</code>를 공유한다.</li><li><code>&lt;q&gt;</code> 랑 <code>&lt;blockquote&gt;</code>는 <code>HTMLQuoteElement</code>를 공유한다.</li><li>etc..</li><li><code>{extends: &#39;blockquote&#39;}</code>를 지정하는 것은 브라우저에게 <code>&lt;blockquote&gt;</code>을 souped-up 하는 것을 알게해준다. <ul><li><code>&lt;q&gt;</code>가 아니고 말이다.</li><li><a href="https://html.spec.whatwg.org/multipage/indices.html#element-interfaces" target="_blank" rel="noopener noreferrer">HTML spec - full list of HTML&#39;s DOM interfaces<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a></li></ul></li></ul><div class="custom-container tip"><p class="custom-container-title">Note</p><p><code>HTMLButtonElement</code>를 확장하는 것은 우리의 팬시한 버튼에 모든 <code>&lt;button&gt;</code>의 DOM 프로퍼티/메소드를 endow한다.</p><p>이는 우리가 직접 구현할 필요가없는 것들 (<code>disabled</code> 프로퍼티, <code>click()</code> 메서드, <code>keydown</code> 리스너, <code>tabindex</code> 관리)을 체크한다. 대신, <code>drawRipple()</code> 메소드를 사용하여 <code>&lt;button&gt;</code>을 custom functionality 왐하께 procressively enhancing를 할 수 있다. 더 적은 코드, 더 많은 재사용!</p></div><ul><li>사용자는 customized built-in element 를 몇 가지 방법으로 이용할 수 있다.</li><li><code>is=&quot;&quot;</code> 어트리뷰트를 native 태그에 추가함으로써 customized built-in element 를 선언할 수 있다.</li></ul><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token comment">&lt;!-- This &lt;button&gt; is a fancy button. --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">is</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>fancy-button<span class="token punctuation">&quot;</span></span> <span class="token attr-name">disabled</span><span class="token punctuation">&gt;</span></span>Fancy button!<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li>자바스크립트로 인스턴스 생성</li></ul><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// Custom elements overload createElement() to support the is=&quot;&quot; attribute.</span>
<span class="token keyword">let</span> button <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&#39;button&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>is<span class="token operator">:</span> <span class="token string">&#39;fancy-button&#39;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
button<span class="token punctuation">.</span>textContent <span class="token operator">=</span> <span class="token string">&#39;Fancy button!&#39;</span><span class="token punctuation">;</span>
button<span class="token punctuation">.</span>disabled <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>button<span class="token punctuation">)</span><span class="token punctuation">;</span>
or use the <span class="token keyword">new</span> <span class="token class-name">operator</span><span class="token operator">:</span>

<span class="token keyword">let</span> button <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FancyButton</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
button<span class="token punctuation">.</span>textContent <span class="token operator">=</span> <span class="token string">&#39;Fancy button!&#39;</span><span class="token punctuation">;</span>
button<span class="token punctuation">.</span>disabled <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><ul><li><code>&lt;img&gt;</code> 확장 예시</li></ul><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>customElements<span class="token punctuation">.</span><span class="token function">define</span><span class="token punctuation">(</span><span class="token string">&#39;bigger-img&#39;</span><span class="token punctuation">,</span> <span class="token keyword">class</span> <span class="token class-name">extends</span> Image <span class="token punctuation">{</span>
  <span class="token comment">// Give img default size if users don&#39;t specify.</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">width<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">,</span> height<span class="token operator">=</span><span class="token number">50</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>width <span class="token operator">*</span><span class="token number">10</span><span class="token punctuation">,</span> height<span class="token operator">*</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token keyword">extends</span><span class="token operator">:</span> <span class="token string">&#39;img&#39;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><ul><li>컴포넌트 정의</li></ul><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token comment">&lt;!-- This &lt;img&gt; is a bigger img. --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">is</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>bigger-img<span class="token punctuation">&quot;</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>15<span class="token punctuation">&quot;</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>20<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li>또는 자바스크립트로 인스턴스 생성</li></ul><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> BiggerImage <span class="token operator">=</span> customElements<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&#39;bigger-img&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> image <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BiggerImage</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// pass constructor values like so.</span>
console<span class="token punctuation">.</span><span class="token function">assert</span><span class="token punctuation">(</span>image<span class="token punctuation">.</span>width <span class="token operator">===</span> <span class="token number">150</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">assert</span><span class="token punctuation">(</span>image<span class="token punctuation">.</span>height <span class="token operator">===</span> <span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="misc-details"><a class="header-anchor" href="#misc-details">#</a> Misc details</h2><h3 id="unknown-elements-vs-undefined-custom-elements"><a class="header-anchor" href="#unknown-elements-vs-undefined-custom-elements">#</a> Unknown elements vs. undefined custom elements</h3><p>HTML 은 작업하기에 유연하고 lenient하다. 예를 들어, <code>&lt;randomtagthatdoesntexist&gt;</code>를 페이지에서 선언하면, 브라우저는 이를 승인하는데 문제가 없다.</p><p>왜 non-standard 태그가 동작할까?</p><p>그 답은 HTML specification 이 허용해주기 때문이다. 스펙에서 정의되지않은 엘리먼트는 HTMLUnknownElement로 parse 된다.</p><p>커스텀 엘리먼트에 관해서는 좀 다르다. 잠재적인 커스텀 엘리먼트는 그들이 valid name(&quot;-&quot;를 포함한)으로 생성되면, HTMLElement 으로 parse 된다.</p><p>브라우저가 이를 적용하는지 체크해볼 수 있다. ctrl / command + shift + j로 콘솔을 열어 다음 코드들을 복붙해보자.</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// &quot;tabs&quot; is not a valid custom element name</span>
document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&#39;tabs&#39;</span><span class="token punctuation">)</span> <span class="token keyword">instanceof</span> <span class="token class-name">HTMLUnknownElement</span> <span class="token operator">===</span> <span class="token boolean">true</span>

<span class="token comment">// &quot;x-tabs&quot; is a valid custom element name</span>
document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&#39;x-tabs&#39;</span><span class="token punctuation">)</span> <span class="token keyword">instanceof</span> <span class="token class-name">HTMLElement</span> <span class="token operator">===</span> <span class="token boolean">true</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="api-reference"><a class="header-anchor" href="#api-reference">#</a> API Reference</h2><p><code>customElements</code> global 은 커스텀엘리먼트와 관련된 유용한 메소드들 정의한다.</p><ul><li><code>define(tagName, constructor, options)</code></li></ul><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>customElements<span class="token punctuation">.</span><span class="token function">define</span><span class="token punctuation">(</span><span class="token string">&#39;my-app&#39;</span><span class="token punctuation">,</span> <span class="token keyword">class</span> <span class="token class-name">extends</span> HTMLElement <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
customElements<span class="token punctuation">.</span><span class="token function">define</span><span class="token punctuation">(</span>
  <span class="token string">&#39;fancy-button&#39;</span><span class="token punctuation">,</span> <span class="token keyword">class</span> <span class="token class-name">extends</span> HTMLButtonElement <span class="token punctuation">{</span> <span class="token operator">...</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token keyword">extends</span><span class="token operator">:</span> <span class="token string">&#39;button&#39;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li><code>get(tagName)</code><ul><li>가능한 커스텀 엘리먼트 이름이 주어지고, 엘리먼트의 컨스트럭터를 반환한다. 등록이 되어있지 않으면 <code>undefined</code> 반환.</li></ul></li></ul><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">let</span> Drawer <span class="token operator">=</span> customElements<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&#39;app-drawer&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> drawer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Drawer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li><code>whenDefined(tagName)</code><ul><li>커스텀 엘리먼트가 정의되었을 때 resolve 하는 Promise 반환.</li><li>이미 엘리먼트가 정의되었으면 곧바로 resolve.</li><li>불가능한 태그명일 때 reject</li></ul></li></ul><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>customElements<span class="token punctuation">.</span><span class="token function">whenDefined</span><span class="token punctuation">(</span><span class="token string">&#39;app-drawer&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;ready!&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="history-and-browser-support"><a class="header-anchor" href="#history-and-browser-support">#</a> History and browser support</h2><ul><li>지난 몇년 간 웹 컴포넌트를 이용해왔다면, Chrome 36+ 은 <code>customElements.define</code> 말고 <code>document.registerElement()</code>가 구현되어 있는 것을 알것이다.</li><li>지금 이건 표준에서 deprecated version인 v0으로 간주된다. <ul><li><a href="https://www.html5rocks.com/en/tutorials/webcomponents/customelements/" target="_blank" rel="noopener noreferrer">v0 스펙 관련 - html5rocks 아티클<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a></li></ul></li><li><code>customElements.define()</code>이 가장 최신이며 브라우저 벤더들이 구현하기 시작한 것이다.</li><li>이를 Custom Elements v1으로 부른다.</li></ul><h3 id="browser-support"><a class="header-anchor" href="#browser-support">#</a> Browser support</h3><ul><li>Chrome 54 (<a href="https://www.chromestatus.com/features/4696261944934400" target="_blank" rel="noopener noreferrer">status<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a>),</li><li>Safari 10.1 (<a href="https://webkit.org/status/#feature-custom-elements" target="_blank" rel="noopener noreferrer">status<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a>),</li><li>Firefox 63 (<a href="https://platform-status.mozilla.org/#custom-elements" target="_blank" rel="noopener noreferrer">status<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a>)</li><li>Edge <code>개발 중</code> <s>역시 구데기</s></li></ul><p>custom elements 기능 감지(feature detection)를 위해서는 <code>window.customElements</code> 존재 체크하기</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> supportsCustomElementsV1 <span class="token operator">=</span> <span class="token string">&#39;customElements&#39;</span> <span class="token keyword">in</span> window<span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><h3 id="polyfill"><a class="header-anchor" href="#polyfill">#</a> Polyfill</h3><ul><li><a href="https://github.com/webcomponents/custom-elements/" target="_blank" rel="noopener noreferrer">standalone polyfill<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a> 이 Custom Elements v1에 대해 존재</li><li>하지만 <a href="https://github.com/webcomponents/webcomponentsjs#using-webcomponents-loaderjs" target="_blank" rel="noopener noreferrer">webcomponents.js loader<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a> 를 사용하여 web components polyfills을 최적화 로드하는 것을 권장</li><li>로더는 브라우저가 요구하는 필수 pollyfills만 비동기적으로 로드하기 위해 기능 감지를 사용한다.</li></ul><div class="custom-container warning"><p class="custom-container-title">Note</p><p>만약 프로젝트가 ES5 로 트랜스파일 되거나, ES5를 사용할 경우 <a href="https://github.com/webcomponents/webcomponentsjs#custom-elements-es5-adapterjs" target="_blank" rel="noopener noreferrer">custom-elements-es5-adapter.js<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a> 룰 추가적으로 사용하라</p></div><ul><li>설치하기</li></ul><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> --save @webcomponents/webcomponentsjs
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><ul><li>사용하기</li></ul><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token comment">&lt;!-- Use the custom element on the page. --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>my-element</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>my-element</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- Load polyfills; note that &quot;loader&quot; will load these async --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>node_modules/@webcomponents/webcomponentsjs/webcomponents-loader.js<span class="token punctuation">&quot;</span></span> <span class="token attr-name">defer</span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- Load a custom element definitions in `waitFor` and return a promise --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>module<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  <span class="token keyword">function</span> <span class="token function">loadScript</span><span class="token punctuation">(</span><span class="token parameter">src</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">const</span> script <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&#39;script&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      script<span class="token punctuation">.</span>src <span class="token operator">=</span> src<span class="token punctuation">;</span>
      script<span class="token punctuation">.</span>onload <span class="token operator">=</span> resolve<span class="token punctuation">;</span>
      script<span class="token punctuation">.</span>onerror <span class="token operator">=</span> reject<span class="token punctuation">;</span>
      document<span class="token punctuation">.</span>head<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>script<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  WebComponents<span class="token punctuation">.</span><span class="token function">waitFor</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token comment">// At this point we are guaranteed that all required polyfills have</span>
    <span class="token comment">// loaded, and can use web components APIs.</span>
    <span class="token comment">// Next, load element definitions that call `customElements.define`.</span>
    <span class="token comment">// Note: returning a promise causes the custom elements</span>
    <span class="token comment">// polyfill to wait until all definitions are loaded and then upgrade</span>
    <span class="token comment">// the document in one batch, for better performance.</span>
    <span class="token keyword">return</span> <span class="token function">loadScript</span><span class="token punctuation">(</span><span class="token string">&#39;my-element.js&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><div class="custom-container danger"><p class="custom-container-title">Note</p><p><strong>defined</strong> CSS pseudo-class cannot be polyfilled.</p></div><hr class="footnotes-sep"><section class="footnotes"><ol class="footnotes-list"><li id="fn1" class="footnote-item"><p>원문 - Generally, you should try to delay work until this time. <a href="#fnref1" class="footnote-backref">↩︎</a></p></li><li id="fn2" class="footnote-item"><p>Flash Of Unstyled Content, 스타일을 불러오기 전 적용되지 않은 페이지가 잠시 나타나는 현상 <a href="#fnref2" class="footnote-backref">↩︎</a></p></li></ol></section><!--]--></div><footer class="page-meta"><!----><div class="meta-item last-updated"><span class="meta-item-label">Last Updated: </span><span class="meta-item-info">4/27/2021, 10:35:32 AM</span></div><!----></footer><!----><!--[--><!--]--></main></div><!----><!--]--></div>
    <script src="/til/assets/js/runtime~app.93d34e3c.js" defer></script><script src="/til/assets/js/8413.98dd209d.js" defer></script><script src="/til/assets/js/app.46f3edf0.js" defer></script>
  </body>
</html>
